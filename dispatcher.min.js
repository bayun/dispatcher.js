function Dispatcher(){this._cbs={c:{}},this.on=function(a,b,c){if(!b)throw"bad callback";a=a.split(/\s+/);var d,e,f,g;while(d=a.shift()){e=d.split(":"),g=this._cbs;while(f=e.shift())g.c[f]||(g.c[f]={c:{}}),g=g.c[f];g.n={cb:b,ct:c,n:g.n}}return this},this.off=function(a,b,c){var d,e,f,g,h,i;a=a.split(/\s+/);while(d=a.shift()){d=d.split(":"),f=this._cbs;while((e=d.shift())&&(f=f.c[e]));if(!b)f.n=!1;else{h=f.n;while(h)h.cb===b&&h.ct===c?h=f.n=h.n:(f=h,h=h.n)}}return this},this.trigger=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r,s,t,u,v,w,x,y;y=a.split(/\s+/),q=["",b,c,d,e,f,g,h,i,j,k,l,m,n,o,p],t=[];while(q[0]=r=y.shift()){r=r.split(":"),s=this._cbs;while((v=r.shift())&&(s=s.c[v])){for(u=s.n;u;u=u.n)t.push(u);t.push(0)}x=0;for(w=t.length-2;w>-1;--w){u=t[w];if(!u){if(x)break}else u.cb.apply(u.ct||this,q)===!1&&(x=1)}}return this}}